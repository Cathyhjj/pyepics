

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>epics.devices Epics Devices &mdash; Epics Channel Access for Python</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '3.0.11',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Epics Channel Access for Python" href="index.html" />
    <link rel="next" title="epics.alarm Epics Alarm" href="alarm.html" />
    <link rel="prev" title="epics.autosave Auto-saving" href="autosave.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="alarm.html" title="epics.alarm Epics Alarm"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="autosave.html" title="epics.autosave Auto-saving"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Epics Channel Access for Python</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><tt class="docutils literal"><span class="pre">epics.devices</span></tt>   Epics Devices</a><ul>
<li><a class="reference internal" href="#module-device">Overview</a></li>
<li><a class="reference internal" href="#module-motor">Epics Motor Device</a><ul>
<li><a class="reference internal" href="#the-epics-motor-class">The <tt class="docutils literal"><span class="pre">epics.Motor</span></tt> class</a></li>
<li><a class="reference internal" href="#methods-for-epics-motor">methods for <tt class="docutils literal"><span class="pre">epics.Motor</span></tt></a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-device-examples">Other Device Examples</a><ul>
<li><a class="reference internal" href="#device-without-a-prefix">Device without a prefix</a></li>
<li><a class="reference internal" href="#epics-ai-record-as-device">Epics ai record as Device</a></li>
<li><a class="reference internal" href="#epics-scaler-record-as-device">Epics Scaler Record as Device</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="autosave.html"
                        title="previous chapter"><tt class="docutils literal docutils literal docutils literal"><span class="pre">epics.autosave</span></tt>  Auto-saving</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="alarm.html"
                        title="next chapter"><tt class="docutils literal docutils literal"><span class="pre">epics.alarm</span></tt>   Epics Alarm</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/devices.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="epics-devices-epics-devices">
<h1><tt class="xref py py-mod docutils literal"><span class="pre">epics.devices</span></tt>   Epics Devices<a class="headerlink" href="#epics-devices-epics-devices" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-device">
<span id="overview"></span><h2>Overview<a class="headerlink" href="#module-device" title="Permalink to this headline">¶</a></h2>
<p>This module provides a simple interface to a collection of PVs.  Here a
<em>device</em> holds a set of PVs, all sharing a prefix, but having many
<em>attributes</em>.  Many PVs will have names made up of <em>prefix+attribute</em>, with
a common prefix for several related PVs.  This almost describes an Epics
Record, but as it is concerned only with PV names, the mapping to an Epics
Record is not exact.  On the other hand, the concept of a <em>device</em> is more
flexible than a predefined Epics Record as it can actually hold PVs from
several different records.:</p>
<div class="highlight-python"><pre>motor1 = epics.Device('XXX:motor1.', attr=('VAL', 'RBV', 'DESC', 'RVAL',
                                           'LVIO', 'HLS', 'LLS'))
motor1.put('VAL', 1)
print 'Motor %s = %f' % ( motor1.get('DESC'), motor1.get('RBV'))

motor1.VAL 0
print 'Motor %s = %f' % ( motor1.DESC, motor1.RBV )</pre>
</div>
<p>While useful on its own like this, the real point of a <em>device</em> is as a
base class, to be inherited and extended.  In fact, there is a more
sophisticated   Motor device described below at <a class="reference internal" href="#device-motor-label"><em>Epics Motor Device</em></a></p>
<dl class="class">
<dt id="device.Device">
<em class="property">class </em><tt class="descclassname">device.</tt><tt class="descname">Device</tt><big>(</big><em>prefix=None</em><span class="optional">[</span>, <em>delim=''</em><span class="optional">[</span>, <em>attrs=None</em><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#device.Device" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>The attribute PVs are built as needed and held in an internal buffer
<tt class="xref py py-data docutils literal"><span class="pre">self._pvs</span></tt>.  This class is kept intentionally simple so that it may
be subclassed.</p>
<p>To pre-load attribute names on initialization, provide a list or tuple of
attributes with the <cite>attr</cite> option.</p>
<p>Note that <em>prefix</em> is actually optional.  When left off, this class can be
used as an arbitrary container of PVs, or to turn any subclass into an
epics Device.</p>
<p>In general, PV names will be mapped as prefix+delim+attr.  See
<a class="reference internal" href="#device.add_pv" title="device.add_pv"><tt class="xref py py-meth docutils literal"><span class="pre">add_pv()</span></tt></a> for details of how to override this.</p>
<dl class="method">
<dt id="device.PV">
<tt class="descclassname">device.</tt><tt class="descname">PV</tt><big>(</big><em>attr[, connect=True[, **kw]]]</em><big>)</big><a class="headerlink" href="#device.PV" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the <cite>PV</cite> object for a device attribute.  The connect argument
and any other keyword arguments are passed to <tt class="xref py py-meth docutils literal"><span class="pre">epics.PV()</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="device.put">
<tt class="descclassname">device.</tt><tt class="descname">put</tt><big>(</big><em>attr</em>, <em>value</em><span class="optional">[</span>, <em>wait=False</em><span class="optional">[</span>, <em>timeout=10.0</em><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#device.put" title="Permalink to this definition">¶</a></dt>
<dd><p>put an attribute value, optionally wait for completion or up to a
supplied timeout value</p>
</dd></dl>

<dl class="method">
<dt id="device.get">
<tt class="descclassname">device.</tt><tt class="descname">get</tt><big>(</big><em>attr</em><span class="optional">[</span>, <em>as_string=False</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#device.get" title="Permalink to this definition">¶</a></dt>
<dd><p>get an attribute value, option as_string returns a string
representation</p>
</dd></dl>

<dl class="method">
<dt id="device.add_callback">
<tt class="descclassname">device.</tt><tt class="descname">add_callback</tt><big>(</big><em>attr</em>, <em>callback</em><big>)</big><a class="headerlink" href="#device.add_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>add a callback function to an attribute PV, so that the callback
function will be run when the at tribute's value changes</p>
</dd></dl>

<dl class="method">
<dt id="device.add_pv">
<tt class="descclassname">device.</tt><tt class="descname">add_pv</tt><big>(</big><em>pvname</em><span class="optional">[</span>, <em>attr=None</em><span class="optional">[</span>, <em>**kw</em><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#device.add_pv" title="Permalink to this definition">¶</a></dt>
<dd><p>adds an explicitly names <tt class="xref py py-meth docutils literal"><span class="pre">epics.PV()</span></tt> to the device even though it
may violate the normal naming rules (in which <cite>attr</cite> is mapped to
<cite>epics.PV(prefix+delim+attr)</cite>.   That is, one can say:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">epics</span>
<span class="n">m1</span> <span class="o">=</span> <span class="n">epics</span><span class="o">.</span><span class="n">Device</span><span class="p">(</span><span class="s">&#39;XXX:m1&#39;</span><span class="p">,</span> <span class="n">delim</span><span class="o">=</span><span class="s">&#39;.&#39;</span><span class="p">)</span>
<span class="n">m1</span><span class="o">.</span><span class="n">add_pv</span><span class="p">(</span><span class="s">&#39;XXX:m2.VAL&#39;</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s">&#39;other&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">m1</span><span class="o">.</span><span class="n">VAL</span>     <span class="c"># print value of XXX:m1.VAL</span>
<span class="k">print</span> <span class="n">m1</span><span class="o">.</span><span class="n">other</span>   <span class="c"># prints value of XXX:m2.VAL</span>
</pre></div>
</div>
</dd></dl>

<dl class="data">
<dt id="device._pvs">
<tt class="descclassname">device.</tt><tt class="descname">_pvs</tt><a class="headerlink" href="#device._pvs" title="Permalink to this definition">¶</a></dt>
<dd><p>a dictionary of PVs making up the device.</p>
</dd></dl>

</div>
<div class="section" id="module-motor">
<span id="epics-motor-device"></span><span id="device-motor-label"></span><h2>Epics Motor Device<a class="headerlink" href="#module-motor" title="Permalink to this headline">¶</a></h2>
<p>The Epics Motor record has over 100 fields associated with it.  Of course,
it is often preferable to think of 1 Motor with many attributes than 100
or so separate PVs.  Many of the fields of the Motor record are
interrelated and influence other settings, including limits on the range of
motion which need to be respected, and which may send notifications when
they are violated.  Thus, there is a fair amount of functionality for a
Motor.  Typically, the user just wants to move the motor by setting its
drive position, but a fully enabled Motor should allow the use to change
and read many of the Motor parameters.</p>
<p>The  <a class="reference internal" href="#motor.Motor" title="motor.Motor"><tt class="xref py py-class docutils literal"><span class="pre">Motor</span></tt></a> class helps the user create and use Epics motors.
A simple example use would be:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">epics</span>
<span class="n">m1</span> <span class="o">=</span> <span class="n">epics</span><span class="o">.</span><span class="n">Motor</span><span class="p">(</span><span class="s">&#39;XXX:m1&#39;</span><span class="p">)</span>

<span class="k">print</span> <span class="s">&#39;Motor:  &#39;</span><span class="p">,</span> <span class="n">m1</span><span class="o">.</span><span class="n">DESC</span> <span class="p">,</span> <span class="s">&#39; Currently at &#39;</span><span class="p">,</span> <span class="n">m1</span><span class="o">.</span><span class="n">RBV</span>

<span class="n">m1</span><span class="o">.</span><span class="n">tweak_val</span> <span class="o">=</span> <span class="mf">0.10</span>
<span class="n">m1</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">dial</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">m1</span><span class="o">.</span><span class="n">tweak</span><span class="p">(</span><span class="nb">dir</span><span class="o">=</span><span class="s">&#39;forward&#39;</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&#39;Motor:  &#39;</span><span class="p">,</span> <span class="n">m1</span><span class="o">.</span><span class="n">DESC</span> <span class="p">,</span> <span class="s">&#39; Currently at &#39;</span><span class="p">,</span> <span class="n">m1</span><span class="o">.</span><span class="n">RBV</span>
</pre></div>
</div>
<p>Which will step the motor through a set of positions.    You'll notice a
few features for Motor:</p>
<blockquote>
<div><p>1.  Motors can use English-name aliases for attributes for fields of the
motor record.  Thus 'VAL' can be spelled 'drive' and 'DESC' can be
'description'.   The Table</p>
<ol class="arabic simple" start="2">
<li>The methods for setting positions can use the User, Dial, or Step coordinate system, and can wait for completion.</li>
</ol>
</div></blockquote>
<div class="section" id="the-epics-motor-class">
<h3>The <tt class="xref py py-class docutils literal"><span class="pre">epics.Motor</span></tt> class<a class="headerlink" href="#the-epics-motor-class" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="motor.Motor">
<em class="property">class </em><tt class="descclassname">motor.</tt><tt class="descname">Motor</tt><big>(</big><em>pvname</em><span class="optional">[</span>, <em>timeout=30.</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#motor.Motor" title="Permalink to this definition">¶</a></dt>
<dd><p>create a Motor object for a named Epics Process Variable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pvname</strong> (<em>string</em>) -- prefix name (no '.VAL' needed!) of Epics Process Variable  for a Motor</li>
<li><strong>timeout</strong> (<em>float</em>) -- time (in seconds) to wait before giving up trying to connect.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Once created, a Motor should be ready to use.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">epics</span> <span class="kn">import</span> <span class="n">Motor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Motor</span><span class="p">(</span><span class="s">&#39;XX:m1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">m</span><span class="o">.</span><span class="n">drive</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">description</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">slew_speed</span>
<span class="go">1.030 Fine X 5.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">m</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;device_type&#39;</span><span class="p">,</span> <span class="n">as_string</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">&#39;asynMotor&#39;</span>
</pre></div>
</div>
<p>A Motor has very many fields.  Only a few of them are created on
initialization -- the rest are retrieved as needed.  The motor fields can
be retrieved either with an attribute or with the <a class="reference internal" href="#motor.get" title="motor.get"><tt class="xref py py-meth docutils literal"><span class="pre">get()</span></tt></a> method.
A full list of Motor attributes and their aliases for the motor
record is given in <a class="reference internal" href="#motorattr-table"><em>Table of Motor Attributes</em></a>.</p>
<blockquote id="motorattr-table">
<div>Table of Aliases for attributes for the epics <a class="reference internal" href="#motor.Motor" title="motor.Motor"><tt class="xref py py-class docutils literal"><span class="pre">Motor</span></tt></a> class, and the
corresponding attribute name of the Motor Record field.</div></blockquote>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="27%" />
<col width="3%" />
<col width="21%" />
<col width="27%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head"><strong>alias</strong></th>
<th class="head"><em>Motor Record field</em></th>
<th class="head">&nbsp;</th>
<th class="head"><strong>alias</strong></th>
<th class="head"><em>Motor Record field</em></th>
</tr>
</thead>
<tbody valign="top">
<tr><td>disabled</td>
<td>_able.VAL</td>
<td>&nbsp;</td>
<td>moving</td>
<td>MOVN</td>
</tr>
<tr><td>acceleration</td>
<td>ACCL</td>
<td>&nbsp;</td>
<td>resolution</td>
<td>MRES</td>
</tr>
<tr><td>back_accel</td>
<td>BACC</td>
<td>&nbsp;</td>
<td>motor_status</td>
<td>MSTA</td>
</tr>
<tr><td>backlash</td>
<td>BDST</td>
<td>&nbsp;</td>
<td>offset</td>
<td>OFF</td>
</tr>
<tr><td>back_speed</td>
<td>BVEL</td>
<td>&nbsp;</td>
<td>output_mode</td>
<td>OMSL</td>
</tr>
<tr><td>card</td>
<td>CARD</td>
<td>&nbsp;</td>
<td>output</td>
<td>OUT</td>
</tr>
<tr><td>dial_high_limit</td>
<td>DHLM</td>
<td>&nbsp;</td>
<td>prop_gain</td>
<td>PCOF</td>
</tr>
<tr><td>direction</td>
<td>DIR</td>
<td>&nbsp;</td>
<td>precision</td>
<td>PREC</td>
</tr>
<tr><td>dial_low_limit</td>
<td>DLLM</td>
<td>&nbsp;</td>
<td>readback</td>
<td>RBV</td>
</tr>
<tr><td>settle_time</td>
<td>DLY</td>
<td>&nbsp;</td>
<td>retry_max</td>
<td>RTRY</td>
</tr>
<tr><td>done_moving</td>
<td>DMOV</td>
<td>&nbsp;</td>
<td>retry_count</td>
<td>RCNT</td>
</tr>
<tr><td>dial_readback</td>
<td>DRBV</td>
<td>&nbsp;</td>
<td>retry_deadband</td>
<td>RDBD</td>
</tr>
<tr><td>description</td>
<td>DESC</td>
<td>&nbsp;</td>
<td>dial_difference</td>
<td>RDIF</td>
</tr>
<tr><td>dial_drive</td>
<td>DVAL</td>
<td>&nbsp;</td>
<td>raw_encoder_pos</td>
<td>REP</td>
</tr>
<tr><td>units</td>
<td>EGU</td>
<td>&nbsp;</td>
<td>raw_high_limit</td>
<td>RHLS</td>
</tr>
<tr><td>encoder_step</td>
<td>ERES</td>
<td>&nbsp;</td>
<td>raw_low_limit</td>
<td>RLLS</td>
</tr>
<tr><td>freeze_offset</td>
<td>FOFF</td>
<td>&nbsp;</td>
<td>relative_value</td>
<td>RLV</td>
</tr>
<tr><td>move_fraction</td>
<td>FRAC</td>
<td>&nbsp;</td>
<td>raw_motor_pos</td>
<td>RMP</td>
</tr>
<tr><td>hi_severity</td>
<td>HHSV</td>
<td>&nbsp;</td>
<td>raw_readback</td>
<td>RRBV</td>
</tr>
<tr><td>hi_alarm</td>
<td>HIGH</td>
<td>&nbsp;</td>
<td>readback_res</td>
<td>RRES</td>
</tr>
<tr><td>hihi_alarm</td>
<td>HIHI</td>
<td>&nbsp;</td>
<td>raw_drive</td>
<td>RVAL</td>
</tr>
<tr><td>high_limit</td>
<td>HLM</td>
<td>&nbsp;</td>
<td>dial_speed</td>
<td>RVEL</td>
</tr>
<tr><td>high_limit_set</td>
<td>HLS</td>
<td>&nbsp;</td>
<td>s_speed</td>
<td>S</td>
</tr>
<tr><td>hw_limit</td>
<td>HLSV</td>
<td>&nbsp;</td>
<td>s_back_speed</td>
<td>SBAK</td>
</tr>
<tr><td>home_forward</td>
<td>HOMF</td>
<td>&nbsp;</td>
<td>s_base_speed</td>
<td>SBAS</td>
</tr>
<tr><td>home_reverse</td>
<td>HOMR</td>
<td>&nbsp;</td>
<td>s_max_speed</td>
<td>SMAX</td>
</tr>
<tr><td>high_op_range</td>
<td>HOPR</td>
<td>&nbsp;</td>
<td>set</td>
<td>SET</td>
</tr>
<tr><td>high_severity</td>
<td>HSV</td>
<td>&nbsp;</td>
<td>stop_go</td>
<td>SPMG</td>
</tr>
<tr><td>integral_gain</td>
<td>ICOF</td>
<td>&nbsp;</td>
<td>s_revolutions</td>
<td>SREV</td>
</tr>
<tr><td>jog_accel</td>
<td>JAR</td>
<td>&nbsp;</td>
<td>stop</td>
<td>STOP</td>
</tr>
<tr><td>jog_forward</td>
<td>JOGF</td>
<td>&nbsp;</td>
<td>t_direction</td>
<td>TDIR</td>
</tr>
<tr><td>jog_reverse</td>
<td>JOGR</td>
<td>&nbsp;</td>
<td>tweak_forward</td>
<td>TWF</td>
</tr>
<tr><td>jog_speed</td>
<td>JVEL</td>
<td>&nbsp;</td>
<td>tweak_reverse</td>
<td>TWR</td>
</tr>
<tr><td>last_dial_val</td>
<td>LDVL</td>
<td>&nbsp;</td>
<td>tweak_val</td>
<td>TWV</td>
</tr>
<tr><td>low_limit</td>
<td>LLM</td>
<td>&nbsp;</td>
<td>use_encoder</td>
<td>UEIP</td>
</tr>
<tr><td>low_limit_set</td>
<td>LLS</td>
<td>&nbsp;</td>
<td>u_revolutions</td>
<td>UREV</td>
</tr>
<tr><td>lo_severity</td>
<td>LLSV</td>
<td>&nbsp;</td>
<td>use_rdbl</td>
<td>URIP</td>
</tr>
<tr><td>lolo_alarm</td>
<td>LOLO</td>
<td>&nbsp;</td>
<td>drive</td>
<td>VAL</td>
</tr>
<tr><td>low_op_range</td>
<td>LOPR</td>
<td>&nbsp;</td>
<td>base_speed</td>
<td>VBAS</td>
</tr>
<tr><td>low_alarm</td>
<td>LOW</td>
<td>&nbsp;</td>
<td>slew_speed</td>
<td>VELO</td>
</tr>
<tr><td>last_rel_val</td>
<td>LRLV</td>
<td>&nbsp;</td>
<td>version</td>
<td>VERS</td>
</tr>
<tr><td>last_dial_drive</td>
<td>LRVL</td>
<td>&nbsp;</td>
<td>max_speed</td>
<td>VMAX</td>
</tr>
<tr><td>last_SPMG</td>
<td>LSPG</td>
<td>&nbsp;</td>
<td>use_home</td>
<td>ATHM</td>
</tr>
<tr><td>low_severity</td>
<td>LSV</td>
<td>&nbsp;</td>
<td>deriv_gain</td>
<td>DCOF</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="methods-for-epics-motor">
<h3>methods for <tt class="xref py py-class docutils literal"><span class="pre">epics.Motor</span></tt><a class="headerlink" href="#methods-for-epics-motor" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="motor.get">
<tt class="descclassname">motor.</tt><tt class="descname">get</tt><big>(</big><em>attr</em><span class="optional">[</span>, <em>as_string=False</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#motor.get" title="Permalink to this definition">¶</a></dt>
<dd><p>sets a field attribute for the motor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>attr</strong> (<em>string (from table above)</em>) -- attribute name</li>
<li><strong>as_string</strong> (<tt class="xref docutils literal"><span class="pre">True</span></tt> or <tt class="xref docutils literal"><span class="pre">False</span></tt>) -- whether to return string value.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Note that <a class="reference internal" href="#motor.get" title="motor.get"><tt class="xref py py-meth docutils literal"><span class="pre">get()</span></tt></a> can return the string value, while fetching the
attribute cannot do so:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">epics</span><span class="o">.</span><span class="n">Motor</span><span class="p">(</span><span class="s">&#39;XXX:m1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">m</span><span class="o">.</span><span class="n">device_type</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">m</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;device_type&#39;</span><span class="p">,</span> <span class="n">as_string</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">&#39;asynMotor&#39;</span>
</pre></div>
</div>
<dl class="method">
<dt id="motor.put">
<tt class="descclassname">motor.</tt><tt class="descname">put</tt><big>(</big><em>attr</em>, <em>value</em><span class="optional">[</span>, <em>wait=False</em><span class="optional">[</span>, <em>timeout=30</em><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#motor.put" title="Permalink to this definition">¶</a></dt>
<dd><p>sets a field attribute for the motor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>attr</strong> (<em>string (from table above)</em>) -- attribute name</li>
<li><strong>value</strong> -- value for attribute</li>
<li><strong>wait</strong> (<tt class="xref docutils literal"><span class="pre">True</span></tt> or <tt class="xref docutils literal"><span class="pre">False</span></tt>) -- whether to wait for completion.</li>
<li><strong>timeout</strong> (<em>float</em>) -- time (in seconds) to wait before giving up trying to connect.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="motor.check_limits">
<tt class="descclassname">motor.</tt><tt class="descname">check_limits</tt><big>(</big><big>)</big><a class="headerlink" href="#motor.check_limits" title="Permalink to this definition">¶</a></dt>
<dd><p>checks whether the current motor position is causing a motor limit
violation, and raises a MotorLimitException if it is.</p>
<p>returns <tt class="xref docutils literal"><span class="pre">None</span></tt> if there is no limit violation.</p>
</dd></dl>

<dl class="method">
<dt id="motor.within_limits">
<tt class="descclassname">motor.</tt><tt class="descname">within_limits</tt><big>(</big><em>value</em><span class="optional">[</span>, <em>limits='user'</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#motor.within_limits" title="Permalink to this definition">¶</a></dt>
<dd><p>checks whether a target value <strong>would be</strong> a limit violation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>value</strong> -- target value</li>
<li><strong>limits</strong> (<em>string</em>) -- one of 'user', 'dial', or 'raw' for which limits to consider</li>
</ul>
</td>
</tr>
<tr class="field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><tt class="xref docutils literal"><span class="pre">True</span></tt>/<tt class="xref docutils literal"><span class="pre">False</span></tt></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="motor.move">
<tt class="descclassname">motor.</tt><tt class="descname">move</tt><big>(</big><em>val=None</em><span class="optional">[</span>, <em>relative=None</em><span class="optional">[</span>, <em>wait=False</em><span class="optional">[</span>, <em>timeout=300.0</em><span class="optional">[</span>, <em>dial=False</em><span class="optional">[</span>, <em>raw=False</em><span class="optional">[</span>, <em>ignore_limits=False</em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#motor.move" title="Permalink to this definition">¶</a></dt>
<dd><p>moves motor drive to position</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>val</strong> -- value to move to (float) [Must be provided]</li>
<li><strong>relative</strong> -- move relative to current position    (T/F) [F]</li>
<li><strong>wait</strong> -- whether to wait for move to complete (T/F) [F]</li>
<li><strong>dial</strong> -- use dial coordinates                 (T/F) [F]</li>
<li><strong>raw</strong> -- use raw coordinates                  (T/F) [F]</li>
<li><strong>ignore_limits</strong> -- try move without regard to limits    (T/F) [F]</li>
<li><strong>timeout</strong> -- max time for move to complete (in seconds) [300]</li>
</ul>
</td>
</tr>
<tr class="field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">see below</p>
</td>
</tr>
</tbody>
</table>
<p>Return codes:</p>
<blockquote>
<div><p>None : unable to move, invalid value given
-1   : target value outside limits -- no move attempted
-2   : with wait=True, wait time exceeded timeout
0    : move executed successfully</p>
<p>will raise an exception if a motor limit is met.</p>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="motor.tweak">
<tt class="descclassname">motor.</tt><tt class="descname">tweak</tt><big>(</big><em>dir='forward'</em><span class="optional">[</span>, <em>wait=False</em><span class="optional">[</span>, <em>timeout=300.</em><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#motor.tweak" title="Permalink to this definition">¶</a></dt>
<dd><p>move the motor by the current <em>tweak value</em></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dir</strong> (<em>string: 'forward' (default) or 'reverse'</em>) -- direction of motion</li>
<li><strong>wait</strong> (<tt class="xref docutils literal"><span class="pre">True</span></tt> or <tt class="xref docutils literal"><span class="pre">False</span></tt>) -- whether to wait for completion</li>
<li><strong>timeout</strong> (<em>float</em>) -- max time for move to complete (in seconds) [default=300]</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="motor.get_position">
<tt class="descclassname">motor.</tt><tt class="descname">get_position</tt><big>(</big><em>readback=False</em><span class="optional">[</span>, <em>dial=False</em><span class="optional">[</span>, <em>raw=False</em><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#motor.get_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the motor position in user, dial or raw coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>readback</strong> -- whether to return the readback position in the
desired coordinate system.  The default is to return the
drive position of the motor.</li>
<li><strong>dial</strong> -- whether to return the position in dial coordinates.
The default is user coordinates.</li>
<li><strong>raw</strong> -- whether to return the raw position.
The default is user coordinates.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The &quot;raw&quot; and &quot;dial&quot; keywords are mutually exclusive.
The &quot;readback&quot; keyword can be used in user, dial or raw coordinates.</p>
</dd></dl>

<dl class="method">
<dt id="motor.set_position">
<tt class="descclassname">motor.</tt><tt class="descname">set_position</tt><big>(</big><em>position[ dial=False[, raw=False]]</em><big>)</big><a class="headerlink" href="#motor.set_position" title="Permalink to this definition">¶</a></dt>
<dd><p>set (that is, redefine) the current position to supplied value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>position</strong> -- The new motor position</li>
<li><strong>dial</strong> -- whether to set in dial coordinates. The default is user coordinates.</li>
<li><strong>raw</strong> -- <p>whether to set in raw coordinates. The default is user  coordinates.</p>
<p>The 'raw' and 'dial' keywords are mutually exclusive.</p>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="motor.get_pv">
<tt class="descclassname">motor.</tt><tt class="descname">get_pv</tt><big>(</big><em>attr</em><big>)</big><a class="headerlink" href="#motor.get_pv" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the <cite>PV</cite> for the corresponding attribute.</p>
</dd></dl>

<dl class="method">
<dt id="motor.set_callback">
<tt class="descclassname">motor.</tt><tt class="descname">set_callback</tt><big>(</big><em>attr='drive'</em><span class="optional">[</span>, <em>callback=None</em><span class="optional">[</span>, <em>kw=None</em><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#motor.set_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>sets a callback on the <cite>PV</cite> for a particular attribute.</p>
</dd></dl>

<dl class="method">
<dt id="motor.clear_callback">
<tt class="descclassname">motor.</tt><tt class="descname">clear_callback</tt><big>(</big><em>attr='drive'</em><big>)</big><a class="headerlink" href="#motor.clear_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>clears a callback on the <cite>PV</cite> for a particular attribute.</p>
</dd></dl>

<dl class="method">
<dt id="motor.show_info">
<tt class="descclassname">motor.</tt><tt class="descname">show_info</tt><big>(</big><big>)</big><a class="headerlink" href="#motor.show_info" title="Permalink to this definition">¶</a></dt>
<dd><p>prints out a table of attributes and their current values.</p>
</dd></dl>

</div>
</div>
<div class="section" id="other-device-examples">
<h2>Other Device Examples<a class="headerlink" href="#other-device-examples" title="Permalink to this headline">¶</a></h2>
<p>As defined here, an epics device provides a general way to group together a
set of PVs.  The examples below show how to build on this generality, and
may inspire you to build your own device classes.</p>
<div class="section" id="device-without-a-prefix">
<h3>Device without a prefix<a class="headerlink" href="#device-without-a-prefix" title="Permalink to this headline">¶</a></h3>
<p>Here is a simple device, that does not even define a prefix.  Thus, all PVs
in the device must be <em>fully qualified</em>, and need not share a prefix.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">epics</span> <span class="kn">import</span> <span class="n">Device</span>
<span class="n">dev</span> <span class="o">=</span> <span class="n">Device</span><span class="p">()</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">PV</span><span class="p">(</span><span class="s">&#39;13IDC:m1.VAL&#39;</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">PV</span><span class="p">(</span><span class="s">&#39;13IDC:m2.VAL&#39;</span><span class="p">)</span>
<span class="n">dev</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s">&#39;13IDC:m1.VAL&#39;</span><span class="p">,</span> <span class="mf">2.8</span><span class="p">)</span>
<span class="n">dev</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s">&#39;13IDC:m2.VAL&#39;</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
<span class="k">print</span> <span class="n">dev</span><span class="o">.</span><span class="n">PV</span><span class="p">(</span><span class="s">&#39;13IDC:m3.DIR&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">as_string</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>This demonstrates that a <cite>Device</cite> is simply a collection of  PVs, which
can be accessed through <tt class="xref py py-meth docutils literal"><span class="pre">PV()</span></tt>.</p>
</div>
<div class="section" id="epics-ai-record-as-device">
<h3>Epics ai record as Device<a class="headerlink" href="#epics-ai-record-as-device" title="Permalink to this headline">¶</a></h3>
<p>Here is a slightly more useful example: An Epics ai (analog input record)
implemented as a Device.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#!/usr/bin/python</span>
<span class="sd">&quot;&quot;&quot;Epics analog input record&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">epics</span>  

<span class="k">class</span> <span class="nc">ai</span><span class="p">(</span><span class="n">epics</span><span class="o">.</span><span class="n">Device</span><span class="p">):</span>
    <span class="s">&quot;Simple analog input device&quot;</span>

    <span class="n">attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;VAL&#39;</span><span class="p">,</span> <span class="s">&#39;EGU&#39;</span><span class="p">,</span> <span class="s">&#39;HOPR&#39;</span><span class="p">,</span> <span class="s">&#39;LOPR&#39;</span><span class="p">,</span> <span class="s">&#39;PREC&#39;</span><span class="p">,</span> <span class="s">&#39;NAME&#39;</span><span class="p">,</span> <span class="s">&#39;DESC&#39;</span><span class="p">,</span>
             <span class="s">&#39;DTYP&#39;</span><span class="p">,</span> <span class="s">&#39;INP&#39;</span><span class="p">,</span> <span class="s">&#39;LINR&#39;</span><span class="p">,</span> <span class="s">&#39;RVAL&#39;</span><span class="p">,</span> <span class="s">&#39;ROFF&#39;</span><span class="p">,</span> <span class="s">&#39;EGUF&#39;</span><span class="p">,</span> <span class="s">&#39;EGUL&#39;</span><span class="p">,</span>
             <span class="s">&#39;AOFF&#39;</span><span class="p">,</span> <span class="s">&#39;ASLO&#39;</span><span class="p">,</span> <span class="s">&#39;ESLO&#39;</span><span class="p">,</span> <span class="s">&#39;EOFF&#39;</span><span class="p">,</span> <span class="s">&#39;SMOO&#39;</span><span class="p">,</span> <span class="s">&#39;HIHI&#39;</span><span class="p">,</span> <span class="s">&#39;LOLO&#39;</span><span class="p">,</span>
             <span class="s">&#39;HIGH&#39;</span><span class="p">,</span> <span class="s">&#39;LOW&#39;</span><span class="p">,</span> <span class="s">&#39;HHSV&#39;</span><span class="p">,</span> <span class="s">&#39;LLSV&#39;</span><span class="p">,</span> <span class="s">&#39;HSV&#39;</span><span class="p">,</span> <span class="s">&#39;LSV&#39;</span><span class="p">,</span> <span class="s">&#39;HYST&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">prefix</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">):</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">.&quot;</span> <span class="o">%</span> <span class="n">prefix</span>
        <span class="n">epics</span><span class="o">.</span><span class="n">Device</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">delim</span><span class="o">=</span><span class="s">&#39;.&#39;</span><span class="p">,</span>
                              <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that we pre-define the fields that are the <em>suffixes</em> of an Epics ai
input record, and simply subclass <tt class="xref py py-class docutils literal"><span class="pre">Device</span></tt> with these fields.  This
<tt class="xref py py-class docutils literal"><span class="pre">ai</span></tt> class can then be used simply and cleanly as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">This_ai</span> <span class="o">=</span> <span class="n">ai</span><span class="p">(</span><span class="s">&#39;XXX.PRES&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;Value: &#39;</span><span class="p">,</span> <span class="n">This_ai</span><span class="o">.</span><span class="n">VAL</span>
<span class="k">print</span> <span class="s">&#39;Units: &#39;</span><span class="p">,</span> <span class="n">This_ai</span><span class="o">.</span><span class="n">EGU</span>
</pre></div>
</div>
<p>Several of the other standard Epics records can easily be exposed as Devices in this way.</p>
</div>
<div class="section" id="epics-scaler-record-as-device">
<h3>Epics Scaler Record as Device<a class="headerlink" href="#epics-scaler-record-as-device" title="Permalink to this headline">¶</a></h3>
<p>And finally a slightly more complicated example: an incomplete, but very
useful mapping of the Scaler Record from synApps, including methods for
changing modes, and reading and writing data.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#!/usr/bin/python </span>
<span class="sd">&quot;&quot;&quot;Epics Scaler&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">epics</span>

<span class="k">class</span> <span class="nc">Scaler</span><span class="p">(</span><span class="n">epics</span><span class="o">.</span><span class="n">Device</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Simple implementation of SynApps Scaler Record.   </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;CNT&#39;</span><span class="p">,</span> <span class="s">&#39;CONT&#39;</span><span class="p">,</span> <span class="s">&#39;TP&#39;</span><span class="p">,</span> <span class="s">&#39;T&#39;</span><span class="p">)</span>
    <span class="n">attr_kws</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;calc_enable&#39;</span><span class="p">:</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">_calcEnable.VAL&#39;</span><span class="p">}</span>
    <span class="n">chan_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;NM</span><span class="si">%i</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;S</span><span class="si">%i</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="n">calc_attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;calc</span><span class="si">%i</span><span class="s">&#39;</span><span class="p">:</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">_calc</span><span class="si">%i</span><span class="s">.VAL&#39;</span><span class="p">,</span> <span class="s">&#39;expr</span><span class="si">%i</span><span class="s">&#39;</span><span class="p">:</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">_calc</span><span class="si">%i</span><span class="s">.CALC&#39;</span><span class="p">}</span>
    
    <span class="n">_fields</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;_prefix&#39;</span><span class="p">,</span> <span class="s">&#39;_pvs&#39;</span><span class="p">,</span> <span class="s">&#39;_delim&#39;</span><span class="p">,</span> <span class="s">&#39;_nchan&#39;</span><span class="p">,</span> <span class="s">&#39;_chans&#39;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">nchan</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nchan</span>  <span class="o">=</span> <span class="n">nchan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_chans</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nchan</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="n">attrs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_chans</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">att</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan_attrs</span><span class="p">:</span>
                <span class="n">attrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">att</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
                
        <span class="n">epics</span><span class="o">.</span><span class="n">Device</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">delim</span><span class="o">=</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">attrs</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attr_kws</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_pv</span><span class="p">(</span><span class="n">val</span> <span class="o">%</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span> <span class="n">key</span><span class="p">)</span>
            
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_chans</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_pv</span><span class="p">(</span><span class="n">val</span> <span class="o">%</span> <span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="n">attr</span> <span class="o">=</span> <span class="n">key</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>

        
    <span class="k">def</span> <span class="nf">AutoCountMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;set to autocount mode&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s">&#39;CONT&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">OneShotMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;set to one shot mode&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s">&#39;CONT&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">CountTime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctime</span><span class="p">):</span>
        <span class="s">&quot;set count time&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s">&#39;TP&#39;</span><span class="p">,</span> <span class="n">ctime</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">Count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctime</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="s">&quot;set count, with optional counttime&quot;</span>
        <span class="k">if</span> <span class="n">ctime</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CountTime</span><span class="p">(</span><span class="n">ctime</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s">&#39;CNT&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">EnableCalcs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot; enable calculations&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s">&#39;calc_enable&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setCalc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">calc</span><span class="p">):</span>
        <span class="s">&quot;set the calculation for scaler i&quot;</span>
        <span class="n">attr</span> <span class="o">=</span> <span class="s">&#39;expr</span><span class="si">%i</span><span class="s">&#39;</span>  <span class="o">%</span> <span class="n">i</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">calc</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;get all names&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;NM</span><span class="si">%i</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_chans</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">Read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_calc</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="s">&quot;read all values&quot;</span>
        <span class="n">attr</span> <span class="o">=</span> <span class="s">&#39;S</span><span class="si">%i</span><span class="s">&#39;</span>
        <span class="k">if</span> <span class="n">use_calc</span><span class="p">:</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="s">&#39;calc</span><span class="si">%i</span><span class="s">&#39;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attr</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_chans</span><span class="p">]</span>
</pre></div>
</div>
<p>Note that we can then create a <tt class="xref py py-class docutils literal"><span class="pre">scaler</span></tt> object from its base PV
prefix, and use methods like <tt class="xref py py-meth docutils literal"><span class="pre">Count()</span></tt> and <tt class="xref py py-meth docutils literal"><span class="pre">Read()</span></tt> without
directly invoking epics calls:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">s1</span> <span class="o">=</span> <span class="n">Scaler</span><span class="p">(</span><span class="s">&#39;XXX:scaler1&#39;</span><span class="p">)</span>
<span class="n">s1</span><span class="o">.</span><span class="n">setCalc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;(B-2000*A/10000000.)&#39;</span><span class="p">)</span>
<span class="n">s1</span><span class="o">.</span><span class="n">enableCalcs</span><span class="p">()</span>
<span class="n">s1</span><span class="o">.</span><span class="n">OneShotMode</span><span class="p">()</span>
<span class="n">s1</span><span class="o">.</span><span class="n">Count</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;Names:       &#39;</span><span class="p">,</span> <span class="n">s1</span><span class="o">.</span><span class="n">getNames</span><span class="p">()</span>
<span class="k">print</span> <span class="s">&#39;Raw  values: &#39;</span><span class="p">,</span> <span class="n">s1</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="n">use_calcs</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;Calc values: &#39;</span><span class="p">,</span> <span class="n">s1</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="n">use_calcs</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="alarm.html" title="epics.alarm Epics Alarm"
             >next</a> |</li>
        <li class="right" >
          <a href="autosave.html" title="epics.autosave Auto-saving"
             >previous</a> |</li>
        <li><a href="index.html">Epics Channel Access for Python</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010, Matthew Newville.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>